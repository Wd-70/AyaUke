"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_src_lib_mongodb_ts";
exports.ids = ["_rsc_src_lib_mongodb_ts"];
exports.modules = {

/***/ "(rsc)/./src/lib/mongodb.ts":
/*!****************************!*\
  !*** ./src/lib/mongodb.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   connectToDatabase: () => (/* binding */ dbConnect),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst MONGODB_URI = process.env.MONGODB_URI;\nif (!MONGODB_URI) {\n    throw new Error('Please define the MONGODB_URI environment variable inside .env.local');\n}\nlet cached = global.mongoose;\nif (!cached) {\n    cached = global.mongoose = {\n        conn: null,\n        promise: null\n    };\n}\nasync function dbConnect() {\n    if (cached.conn) {\n        // console.log('üîÑ Í∏∞Ï°¥ MongoDB Ïó∞Í≤∞ Ïû¨ÏÇ¨Ïö©');\n        return cached.conn;\n    }\n    if (!cached.promise) {\n        // console.log('üöÄ ÏÉàÎ°úÏö¥ MongoDB Ïó∞Í≤∞ ÏãúÏûë...');\n        // console.log('üìç MongoDB URI:', MONGODB_URI ? 'URI ÏÑ§Ï†ïÎê®' : 'URI ÏóÜÏùå');\n        const opts = {\n            bufferCommands: false,\n            serverSelectionTimeoutMS: 8000,\n            connectTimeoutMS: 8000,\n            socketTimeoutMS: 8000,\n            // Ïû¨ÏãúÎèÑ ÏòµÏÖò\n            retryWrites: true,\n            retryReads: true,\n            maxPoolSize: 10,\n            minPoolSize: 1,\n            maxIdleTimeMS: 30000,\n            // Heartbeat ÏòµÏÖò\n            heartbeatFrequencyMS: 10000\n        };\n        cached.promise = mongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(MONGODB_URI, opts).then((mongoose)=>{\n            // console.log('‚úÖ MongoDB Ïó∞Í≤∞ ÏÑ±Í≥µ!');\n            return mongoose;\n        });\n    }\n    try {\n        cached.conn = await cached.promise;\n    } catch (e) {\n        console.error('‚ùå MongoDB Ïó∞Í≤∞ Ïã§Ìå®:', e);\n        cached.promise = null;\n        throw e;\n    }\n    return cached.conn;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (dbConnect);\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL21vbmdvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFnQztBQUVoQyxNQUFNQyxjQUFjQyxRQUFRQyxHQUFHLENBQUNGLFdBQVc7QUFFM0MsSUFBSSxDQUFDQSxhQUFhO0lBQ2hCLE1BQU0sSUFBSUcsTUFDUjtBQUVKO0FBV0EsSUFBSUMsU0FBU0MsT0FBT04sUUFBUTtBQUU1QixJQUFJLENBQUNLLFFBQVE7SUFDWEEsU0FBU0MsT0FBT04sUUFBUSxHQUFHO1FBQUVPLE1BQU07UUFBTUMsU0FBUztJQUFLO0FBQ3pEO0FBRUEsZUFBZUM7SUFDYixJQUFJSixPQUFPRSxJQUFJLEVBQUU7UUFDZix1Q0FBdUM7UUFDdkMsT0FBT0YsT0FBT0UsSUFBSTtJQUNwQjtJQUVBLElBQUksQ0FBQ0YsT0FBT0csT0FBTyxFQUFFO1FBQ25CLDBDQUEwQztRQUMxQyxzRUFBc0U7UUFFdEUsTUFBTUUsT0FBTztZQUNYQyxnQkFBZ0I7WUFDaEJDLDBCQUEwQjtZQUMxQkMsa0JBQWtCO1lBQ2xCQyxpQkFBaUI7WUFDakIsU0FBUztZQUNUQyxhQUFhO1lBQ2JDLFlBQVk7WUFDWkMsYUFBYTtZQUNiQyxhQUFhO1lBQ2JDLGVBQWU7WUFDZixlQUFlO1lBQ2ZDLHNCQUFzQjtRQUN4QjtRQUVBZixPQUFPRyxPQUFPLEdBQUdSLHVEQUFnQixDQUFDQyxhQUFjUyxNQUFNWSxJQUFJLENBQUMsQ0FBQ3RCO1lBQzFELG1DQUFtQztZQUNuQyxPQUFPQTtRQUNUO0lBQ0Y7SUFFQSxJQUFJO1FBQ0ZLLE9BQU9FLElBQUksR0FBRyxNQUFNRixPQUFPRyxPQUFPO0lBQ3BDLEVBQUUsT0FBT2UsR0FBRztRQUNWQyxRQUFRQyxLQUFLLENBQUMsb0JBQW9CRjtRQUNsQ2xCLE9BQU9HLE9BQU8sR0FBRztRQUNqQixNQUFNZTtJQUNSO0lBRUEsT0FBT2xCLE9BQU9FLElBQUk7QUFDcEI7QUFFQSxpRUFBZUUsU0FBU0EsRUFBQztBQUNpQiIsInNvdXJjZXMiOlsiL21udC9mL0RhdGEvR2l0L2NsYXVkZS1jb2RlL2F5YXVrZS1wYWdlL2F5YXVrZS1wYWdlL3NyYy9saWIvbW9uZ29kYi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSAnbW9uZ29vc2UnO1xyXG5cclxuY29uc3QgTU9OR09EQl9VUkkgPSBwcm9jZXNzLmVudi5NT05HT0RCX1VSSTtcclxuXHJcbmlmICghTU9OR09EQl9VUkkpIHtcclxuICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAnUGxlYXNlIGRlZmluZSB0aGUgTU9OR09EQl9VUkkgZW52aXJvbm1lbnQgdmFyaWFibGUgaW5zaWRlIC5lbnYubG9jYWwnXHJcbiAgKTtcclxufVxyXG5cclxuaW50ZXJmYWNlIE1vbmdvb3NlQ2FjaGUge1xyXG4gIGNvbm46IHR5cGVvZiBtb25nb29zZSB8IG51bGw7XHJcbiAgcHJvbWlzZTogUHJvbWlzZTx0eXBlb2YgbW9uZ29vc2U+IHwgbnVsbDtcclxufVxyXG5cclxuZGVjbGFyZSBnbG9iYWwge1xyXG4gIHZhciBtb25nb29zZTogTW9uZ29vc2VDYWNoZTtcclxufVxyXG5cclxubGV0IGNhY2hlZCA9IGdsb2JhbC5tb25nb29zZTtcclxuXHJcbmlmICghY2FjaGVkKSB7XHJcbiAgY2FjaGVkID0gZ2xvYmFsLm1vbmdvb3NlID0geyBjb25uOiBudWxsLCBwcm9taXNlOiBudWxsIH07XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGRiQ29ubmVjdCgpOiBQcm9taXNlPHR5cGVvZiBtb25nb29zZT4ge1xyXG4gIGlmIChjYWNoZWQuY29ubikge1xyXG4gICAgLy8gY29uc29sZS5sb2coJ/CflIQg6riw7KG0IE1vbmdvREIg7Jew6rKwIOyerOyCrOyaqScpO1xyXG4gICAgcmV0dXJuIGNhY2hlZC5jb25uO1xyXG4gIH1cclxuXHJcbiAgaWYgKCFjYWNoZWQucHJvbWlzZSkge1xyXG4gICAgLy8gY29uc29sZS5sb2coJ/CfmoAg7IOI66Gc7Jq0IE1vbmdvREIg7Jew6rKwIOyLnOyekS4uLicpO1xyXG4gICAgLy8gY29uc29sZS5sb2coJ/Cfk40gTW9uZ29EQiBVUkk6JywgTU9OR09EQl9VUkkgPyAnVVJJIOyEpOygleuQqCcgOiAnVVJJIOyXhuydjCcpO1xyXG4gICAgXHJcbiAgICBjb25zdCBvcHRzID0ge1xyXG4gICAgICBidWZmZXJDb21tYW5kczogZmFsc2UsXHJcbiAgICAgIHNlcnZlclNlbGVjdGlvblRpbWVvdXRNUzogODAwMCwgLy8gOOy0iOuhnCDspp3qsIBcclxuICAgICAgY29ubmVjdFRpbWVvdXRNUzogODAwMCxcclxuICAgICAgc29ja2V0VGltZW91dE1TOiA4MDAwLFxyXG4gICAgICAvLyDsnqzsi5zrj4Qg7Ji17IWYXHJcbiAgICAgIHJldHJ5V3JpdGVzOiB0cnVlLFxyXG4gICAgICByZXRyeVJlYWRzOiB0cnVlLFxyXG4gICAgICBtYXhQb29sU2l6ZTogMTAsXHJcbiAgICAgIG1pblBvb2xTaXplOiAxLFxyXG4gICAgICBtYXhJZGxlVGltZU1TOiAzMDAwMCxcclxuICAgICAgLy8gSGVhcnRiZWF0IOyYteyFmFxyXG4gICAgICBoZWFydGJlYXRGcmVxdWVuY3lNUzogMTAwMDAsXHJcbiAgICB9O1xyXG5cclxuICAgIGNhY2hlZC5wcm9taXNlID0gbW9uZ29vc2UuY29ubmVjdChNT05HT0RCX1VSSSEsIG9wdHMpLnRoZW4oKG1vbmdvb3NlKSA9PiB7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKCfinIUgTW9uZ29EQiDsl7DqsrAg7ISx6rO1IScpO1xyXG4gICAgICByZXR1cm4gbW9uZ29vc2U7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjYWNoZWQuY29ubiA9IGF3YWl0IGNhY2hlZC5wcm9taXNlO1xyXG4gIH0gY2F0Y2ggKGUpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBNb25nb0RCIOyXsOqysCDsi6TtjKg6JywgZSk7XHJcbiAgICBjYWNoZWQucHJvbWlzZSA9IG51bGw7XHJcbiAgICB0aHJvdyBlO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGNhY2hlZC5jb25uO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBkYkNvbm5lY3Q7XHJcbmV4cG9ydCB7IGRiQ29ubmVjdCBhcyBjb25uZWN0VG9EYXRhYmFzZSB9OyJdLCJuYW1lcyI6WyJtb25nb29zZSIsIk1PTkdPREJfVVJJIiwicHJvY2VzcyIsImVudiIsIkVycm9yIiwiY2FjaGVkIiwiZ2xvYmFsIiwiY29ubiIsInByb21pc2UiLCJkYkNvbm5lY3QiLCJvcHRzIiwiYnVmZmVyQ29tbWFuZHMiLCJzZXJ2ZXJTZWxlY3Rpb25UaW1lb3V0TVMiLCJjb25uZWN0VGltZW91dE1TIiwic29ja2V0VGltZW91dE1TIiwicmV0cnlXcml0ZXMiLCJyZXRyeVJlYWRzIiwibWF4UG9vbFNpemUiLCJtaW5Qb29sU2l6ZSIsIm1heElkbGVUaW1lTVMiLCJoZWFydGJlYXRGcmVxdWVuY3lNUyIsImNvbm5lY3QiLCJ0aGVuIiwiZSIsImNvbnNvbGUiLCJlcnJvciIsImNvbm5lY3RUb0RhdGFiYXNlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/mongodb.ts\n");

/***/ })

};
;